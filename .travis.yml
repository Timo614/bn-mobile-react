---
  os: osx
  language: node_js
  osx_image: xcode10.1
  node_js:
    - node
    - lts/*
  cache:
    directories:
      - "~/.npm"
  before_install:
    - gem update --system
    - echo -e "machine github.com\n  login $APPLE_USERNAME\n  password $CI_USER_PASSWORD" >> ~/.netrc
  before_script:
    - bundle update
    - bundle install
    - npm i -g npm@latest
  script:
    - npm ci
    - npx jest --ci
  jobs:
    include:
      - stage: deploy
        if: branch = 172-deploy
        node_js: lts/*
        script:
          - npm ci
          - npm install -g expo-cli
          - npx expo login -u $EXPO_USERNAME -p $EXPO_PASSWORD
          - "./deploy"
  env:
    - FASTLANE_SESSION=---\n- !ruby/object:HTTP::Cookie\n  name: myacinfo\n  value: DAWTKNV2d43899797146bc6678e32c2ee27e70d319cccde17c4aa211deb07861358d6abc36675d72f2791a45b3cf8c45025275cc088c45b30d20296642930138ee12f4aad65a2da1e84079351a9f84de2111b348af07138a1b40573999e607c473048e26a03ac7582766d1d700d36d57468fdbb7acf842a10a14a2e4778db0cef0f3fb2253bd07a7a086adc99913fe5b2d2e44fade714540b46d9037345b4d759c396fbcc6431650c8867a60771aaf1994543e1918eb583980c4815dd1137b45e58802769794335b7ed9a6742a5962655421bc8c56e7b72b46b292c8154325b9b5f3fcf201544d368d7b41b5fee1583becaadc87beb2ada61cec14b9d468c239b0b51aa5a1c8646dbd705057ac986627d9a5848f5d96ec9ee237bd0a478c3f45d5532499865a1e465083b54ea599af7f9c6b88d50cd0cda2a6c67c6e70016efab9873657b8b2404bb29462e1dda4dda77442f2cc2a348ad5bc538d7167255b948ed3532b39306362343761666665316335306131363964313530366262633965316230376533333163353137MVRYV2\n  domain: apple.com\n  for_domain: true\n  path: "/"\n  secure: true\n  httponly: true\n  expires: \n  max_age: \n  created_at: 2018-11-06 00:26:31.027717000 -06:00\n  accessed_at: 2018-11-06 00:26:31.041582000 -06:00\n- !ruby/object:HTTP::Cookie\n  name: dqsid\n  value: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJqdGkiOiJFYzNuYm9vXzNuOUJZU2lJM0FXS0lBIn0.DjjUizwThjbttp1wrN1skXP0109RsG2xe-NAcQ-gG-0\n  domain: olympus.itunes.apple.com\n  for_domain: false\n  path: "/"\n  secure: true\n  httponly: true\n  expires: \n  max_age: 1800\n  created_at: &1 2018-11-06 00:26:31.667123000 -06:00\n  accessed_at: *1\n