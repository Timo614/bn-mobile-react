language: node_js
node_js:
- node
- lts/*
cache:
  directories:
  - "~/.npm"
before_install:
- echo -e "machine github.com\n login $CI_USER_TOKEN"
  >> ~/.netrc
before_script:
- bundle install
- npm install -g expo-cli
- npm i -g npm@latest
script:
- npm install -g expo-cli
- npm ci
- npx jest --ci
jobs:
  include:
  - stage: deploy
    if: branch = 172-deploy
    node_js: lts/*
    script:
    - npm ci
    - npm install -g expo-cli
    - npx expo login -u $EXPO_USERNAME -p $EXPO_PASSWORD
    - ./deploy